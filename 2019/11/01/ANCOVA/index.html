<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Statistics02-ANCOVA | zxcheergo&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="什么是协方差分析不属于实验操作变量（自变量）的其他连续型变量，但对因变量会有影响，将它们称为协变量，对协变量的分析称为协方差分析。使用协方差分析的原因：  减少残差的变异型： 如果可以依靠协变量解释残差 $(SS_R)$ ，便可以减少误差项的方差，从而更准确评估自变量的影响$(SS_M)$。 剔除confounds变量的影响">
<meta name="keywords" content="Statistics">
<meta property="og:type" content="article">
<meta property="og:title" content="Statistics02-ANCOVA">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2019&#x2F;11&#x2F;01&#x2F;ANCOVA&#x2F;index.html">
<meta property="og:site_name" content="zxcheergo&#39;s blog">
<meta property="og:description" content="什么是协方差分析不属于实验操作变量（自变量）的其他连续型变量，但对因变量会有影响，将它们称为协变量，对协变量的分析称为协方差分析。使用协方差分析的原因：  减少残差的变异型： 如果可以依靠协变量解释残差 $(SS_R)$ ，便可以减少误差项的方差，从而更准确评估自变量的影响$(SS_M)$。 剔除confounds变量的影响">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-11-09T02:09:35.508Z">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="zxcheergo&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">zxcheergo&#39;s blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-ANCOVA" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/11/01/ANCOVA/" class="article-date">
  <time datetime="2019-11-01T00:00:00.000Z" itemprop="datePublished">2019-11-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Statistics02-ANCOVA
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="什么是协方差分析"><a href="#什么是协方差分析" class="headerlink" title="什么是协方差分析"></a>什么是协方差分析</h3><p>不属于实验操作变量（自变量）的其他连续型变量，但对因变量会有影响，将它们称为<strong>协变量</strong>，对协变量的分析称为协方差分析。<br>使用协方差分析的原因：</p>
<ul>
<li>减少残差的变异型： 如果可以依靠协变量解释残差 $(SS_R)$ ，便可以减少误差项的方差，从而更准确评估自变量的影响$(SS_M)$。</li>
<li>剔除confounds变量的影响<a id="more"></a>

</li>
</ul>
<h4 id="协方差分析的方差的分解"><a href="#协方差分析的方差的分解" class="headerlink" title="协方差分析的方差的分解"></a>协方差分析的方差的分解</h4><p>类似于ANOVA，可以将协方差分析的方差$SS_T$分解为$SS_M$和$SS_R$，由于协变量的存在，协变量既可以解释模型带来的方差又可以解释部分的残差，从而通过控制这部分的<strong>公共方差</strong>可以达到提高$F=\frac{Model}{Residal}$检验量的效果。</p>
<ul>
<li>因变量的分解类似于ANOVA<br>$$SST_y=\Sigma_{i=1}^k(y_i-\bar{y})^2=SSM_y+SSR_y$$</li>
<li>协变量的分解分为两部分，一部分是协变量自身的方差的分解：<br>$$SST_x=\Sigma_{i=1}^k(x_i-\bar{x})^2=SSM_x+SSR_x$$</li>
<li>另一部分则是协变量与因变量的共同协方差：<br>$$SPT=\Sigma_{i=1}^N\Sigma_{j=1}^{n_i}(y_{ij}-\bar{y})(\bar{x_i}-\bar{x})+\Sigma_{i=1}^k\Sigma_{j=1}^{n_i}(y_{ij}-\bar{y_i})(x_{ij}-\bar{x_i})=SPM+SPR$$</li>
<li>最后，利用协变量的方差项来修正$SSM$和$SSR$:<br>$$SSM_y’=SSM_y-[\frac{SPT^2}{SST_x}-\frac{SPR^2}{SSR_x}]$$<br>$$SSR_y’=SSR_y-\frac{SPR^2}{SSR_x}$$</li>
</ul>
<h3 id="使用ANCOVA的假设"><a href="#使用ANCOVA的假设" class="headerlink" title="使用ANCOVA的假设"></a>使用ANCOVA的假设</h3><p>在ANOVA的基础上，还有两个额外的假设：</p>
<h4 id="协变量与实验控制变量的效果是独立的"><a href="#协变量与实验控制变量的效果是独立的" class="headerlink" title="协变量与实验控制变量的效果是独立的"></a>协变量与实验控制变量的效果是独立的</h4><p>在理想情况下，协变量解释的方差应该与实验操作无法解释的方差有重叠，而与实验控制变量解释的方差无重叠，这样在剔除协变量方差时可以减少误差项的方差，从而增强实验变量的效果。</p>
<h4 id="回归斜率的一致性"><a href="#回归斜率的一致性" class="headerlink" title="回归斜率的一致性"></a>回归斜率的一致性</h4><p>如果以协变量作为x轴，因变量作为y轴，先不考虑自变量的影响，将所有的数据绘制在一张图上，回归斜率一致是指：不同组（以不同的自变量的水平划分）构成的数据集，绘制回归线，这些回归线的斜率应该是相同的。</p>
<h3 id="用R进行ANCOVA的步骤"><a href="#用R进行ANCOVA的步骤" class="headerlink" title="用R进行ANCOVA的步骤"></a>用R进行ANCOVA的步骤</h3><ol>
<li>输入数据</li>
<li>探索数据，得到描述性统计，并进行参数统计的适用性检测</li>
<li>检查协变量与任意的自变量之间的独立性，以协变量作为outcome，进行ANOVA，如果得到显著性的结果，则说明协变量与自变量独立性假设无效</li>
<li>进行ANCOVA</li>
<li>进行事后比较或者contrast</li>
<li>检查回归斜率是否一致：再次进行ANCOVA，纳入自变量与协变量的交互作用，如果交互作用显著，则回归斜率一致假设无效</li>
</ol>
<h3 id="ANCOVA使用注意点"><a href="#ANCOVA使用注意点" class="headerlink" title="ANCOVA使用注意点"></a>ANCOVA使用注意点</h3><h4 id="预测变量的输入顺序"><a href="#预测变量的输入顺序" class="headerlink" title="预测变量的输入顺序"></a>预测变量的输入顺序</h4><p>如果使用<code>aov(outcome ~ pred + cov, data)</code> 命令，输入自变量与协变量的顺序的不同会导致结果的不同，所以，在进行ANCOVA之前，需要考虑两个问题：</p>
<ul>
<li>采用哪种方式来计算SS？</li>
<li>采用何种contrast的建立方式？</li>
</ul>
<h5 id="sum-of-square的类型"><a href="#sum-of-square的类型" class="headerlink" title="sum of square的类型"></a>sum of square的类型</h5><p>一共有4种计算SS的方式</p>
<ol>
<li>Type I：采用分级回归的方式，即按照变量的顺序，依次考虑输入变量的影响。例如有三个变量$x_1, x_2, x_3$按顺序输入模型，则在该方式下计算SS会先考仅仅考虑$x_1$而不考虑其他两个变量，再在考虑$x_1$的前提下计算$x_2$，再在考虑$x_1$和$x_2$的前提下计算$x_3$。<strong>适用场景</strong>：除非是变量之间是完全彼此独立的，否则用这种计算方式难以真实评价各个变量的主效应。</li>
<li>Type III：在计算一个变量的影响时，会将其他所有变量的影响都考虑进去，而不会在意变量的输入顺序。<strong>特点</strong>：由于是在考虑交互效应的同时去考虑主效应的，如果交互效应显著，则关于主效应是否显著的推断则需要慎重。</li>
<li>Type II：与Type III类似，唯一不同的是它不会考虑高阶交互项的影响，例如现在要分析某个主效应的影响，则只会考虑其他所有的主效应变量的影响，而不会考虑任意的交互项。</li>
<li>总结：<br>使用哪种SS的计算方式取决于假设是什么，如果是围绕着交互项研究，则方式II和III得到的结果是一样的；而如果只研究主效应，而不想预测交互效应，则使用方式II；如果设计是不平衡的，采用方式III。</li>
</ol>
<h5 id="ANCOVA中的constrast"><a href="#ANCOVA中的constrast" class="headerlink" title="ANCOVA中的constrast"></a>ANCOVA中的constrast</h5><p><strong>注意</strong>在使用Type III计算SS时，必须采用的constrast设计。</p>
<h5 id="考虑了协变量后对因变量的均值的修正"><a href="#考虑了协变量后对因变量的均值的修正" class="headerlink" title="考虑了协变量后对因变量的均值的修正"></a>考虑了协变量后对因变量的均值的修正</h5>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/11/01/ANCOVA/" data-id="ck4i9w9j500007jqpdsmw49hr" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Statistics/" rel="tag">Statistics</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2019/10/28/Statistic01/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Statistics01_Basic Assumptions</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AWS-blog/" rel="tag">AWS, blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Statistics/" rel="tag">Statistics</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/AWS-blog/" style="font-size: 10px;">AWS, blog</a> <a href="/tags/Statistics/" style="font-size: 20px;">Statistics</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/11/01/ANCOVA/">Statistics02-ANCOVA</a>
          </li>
        
          <li>
            <a href="/2019/10/28/Statistic01/">Statistics01_Basic Assumptions</a>
          </li>
        
          <li>
            <a href="/2019/10/24/%E5%A6%82%E4%BD%95%E5%9C%A8AWS%E4%B8%8A%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/">如何在AWS上部署Hexo个人博客</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 zxcheergo<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>